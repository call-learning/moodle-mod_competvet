{"version":3,"file":"manager_app_planning.min.js","sources":["../../../src/local/manager/manager_app_planning.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Moves wrapping navigation items into a more menu.\n *\n * @module     mod_competvet/local/manager/manager_app_planning\n * @class      competvet\n * @copyright  2024 Bas Brands\n * @author     Bas Brands <bas@sonsbeekmedia.nl>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport CompetState from 'mod_competvet/local/competstate';\nimport Repository from 'mod_competvet/local/new-repository';\nimport Notification from 'core/notification';\nimport './plannings';\nimport ModalSaveCancel from 'core/modal_save_cancel';\nimport {getString, getStrings} from 'core/str';\nimport ModalEvents from 'core/modal_events';\n\n/*\n* A CRUD manager for data.\n*/\nclass Manager {\n\n    /**\n     * Constructor.\n     */\n    constructor() {\n        this.app = document.querySelector('[data-region=\"planning\"]');\n        this.cmId = this.app.dataset.cmId;\n        this.situationId = this.app.dataset.situationId;\n        this.dataset = this.app.region;\n        this.addEventListeners();\n        this.getData();\n    }\n\n    /**\n     * Get the data for this manager.\n     */\n    async getData() {\n        const response = await Repository.getPlannings(this.cmId);\n        if (!response) {\n            return;\n        }\n        CompetState.setData(response);\n    }\n\n    /**\n     * Add event listeners to the page.\n     * @return {void}\n     */\n    addEventListeners() {\n        document.addEventListener('click', (e) => {\n            let btn = e.target.closest('[data-action]');\n            if (btn) {\n                e.preventDefault();\n                this.actions(btn);\n            }\n        });\n        this.app.classList.add('jsenabled');\n    }\n\n    /**\n     * Actions.\n     * @param {object} btn The button that was clicked.\n     */\n    async actions(btn) {\n        if (btn.dataset.action === 'add') {\n            this.add(btn);\n        }\n        if (btn.dataset.action === 'edit') {\n            this.edit(btn);\n        }\n        if (btn.dataset.action === 'save') {\n            const result = await this.save();\n            if (result) {\n                this.stopEdit();\n            }\n        }\n        if (btn.dataset.action === 'delete') {\n            this.delete(btn);\n        }\n        if (btn.dataset.action === 'deleteall') {\n            this.deleteAll(btn);\n        }\n    }\n\n    /**\n     * Add a new planning or category by manipulating the state, for the state structure see the example data structure.\n     * @param {object} btn The button that was clicked.\n     */\n    add(btn) {\n        let state = CompetState.getData();\n        if (btn.dataset.type === 'planning') {\n            state.plannings.push({\n                id: 0,\n                situationid: this.situationId, // TODO set the correct situation id.\n                startdate: this.getSuggested('startdate'),\n                enddate: this.getSuggested('enddate'),\n                groupid: '',\n                session: this.getSuggested('session'),\n                edit: true,\n                groups: state.groups,\n                pauses: [],\n            });\n        }\n        if (btn.dataset.type === 'pause') {\n            const planningid = parseInt(btn.dataset.id);\n            const planning = state.plannings.find((element) => element.id === planningid);\n            planning.pauses.push({\n                id: 0,\n                planningid: planningid,\n                startdate: planning.startdate,\n                enddate: planning.enddate,\n                editpause: true,\n            });\n        }\n        CompetState.setData(state);\n    }\n\n    /**\n     * Delete a planning or category by manipulating the state, for the state structure see the example data structure.\n     * @param {object} btn The button that was clicked.\n     */\n    async delete(btn) {\n        let state = CompetState.getData();\n        if (btn.dataset.type === 'planning') {\n            const planning = state.plannings.find((element) => element.id === parseInt(btn.dataset.id));\n            const deletePlanning = () => {\n                state.plannings.find((element) => element.id === parseInt(btn.dataset.id)).deleted = true;\n                CompetState.setData(state);\n                this.save();\n            };\n            if (planning.hasuserdata) {\n                const modal = await ModalSaveCancel.create({\n                    title: getString('delete', 'mod_competvet'),\n                    body: getString('confirmplanningdelete', 'mod_competvet'),\n                });\n                modal.show();\n                modal.getRoot().on(ModalEvents.save, () => {\n                    deletePlanning();\n                });\n            } else {\n                deletePlanning();\n            }\n        }\n        if (btn.dataset.type === 'pause') {\n            const pauseid = parseInt(btn.dataset.id);\n            const pause = this.getPause(pauseid);\n            pause.deleted = true;\n            CompetState.setData(state);\n            this.save();\n        }\n    }\n\n    /**\n     * Delete all plannings.\n     */\n    async deleteAll() {\n        const state = CompetState.getData();\n        if (state.plannings.length === 0) {\n            return;\n        }\n        const confirmationStrings = await getStrings([\n            {\n                key: 'confirm',\n                component: 'mod_competvet',\n            },\n            {\n                key: 'deleteallinfo',\n                component: 'mod_competvet',\n            },\n            {\n                key: 'confirmplanningdeleteall',\n                component: 'mod_competvet',\n            },\n            {\n                key: 'cancel',\n                component: 'mod_competvet',\n            },\n        ]);\n        Notification.confirm(\n            ...confirmationStrings,\n            () => {\n                state.plannings.forEach((planning) => {\n                    planning.deleted = true;\n                });\n                CompetState.setData(state);\n                this.save();\n            },\n            () => {\n                // Do nothing, the user cancelled the action.\n            },\n        );\n    }\n\n\n    /**\n     * Edit a planning or category by manipulating the state, for the state structure see the example data structure.\n     * All fields in the button container row with data-fieldtype will be made editable.\n     * @param {object} btn The button that was clicked.\n     */\n    edit(btn) {\n        let state = CompetState.getData();\n        // Remove edit from all fields.\n        state.plannings.forEach((element) => {\n            element.edit = false;\n            element.pauses.forEach((pause) => {\n                pause.editpause = false;\n            });\n        });\n        if (btn.dataset.type === 'planning') {\n            let planning = state.plannings.find((element) => element.id === parseInt(btn.dataset.id));\n            planning.edit = true;\n        }\n        if (btn.dataset.type === 'pause') {\n            const pause = this.getPause(parseInt(btn.dataset.id));\n            if (pause) {\n                pause.editpause = true;\n            }\n        }\n        CompetState.setData(state);\n    }\n\n    /**\n     * Get the pause object from the state.\n     * @param {Int} id The id of the pause.\n     * @return {Object} The pause object.\n     */\n    getPause(id) {\n        const state = CompetState.getData();\n        for (const planning of state.plannings) {\n            if (planning.pauses) {\n                const pause = planning.pauses.find((element) => element.id === id);\n                if (pause) {\n                    return pause;\n                }\n            }\n        }\n        return null;\n    }\n\n    /**\n     * Stop editing, remove the edit flag from the state elements.\n     */\n    stopEdit() {\n        const state = CompetState.getData();\n        // Remove edit from all fields.\n        state.plannings.forEach((element) => {\n            element.edit = false;\n            element.pauses.forEach((pause) => {\n                pause.editpause = false;\n            });\n        });\n        CompetState.setData(state);\n    }\n\n    update() {\n        const state = CompetState.getData();\n        state.plannings.forEach((element) => {\n            element.haschanged = false;\n            if (element.edit) {\n                // Update the grid with the new values from the UI.\n                element.haschanged = true;\n                element.startdate = this.getValue('planitem', 'startdate', element.id);\n                element.enddate = this.getValue('planitem', 'enddate', element.id);\n                element.groupid = this.getValue('planitem', 'groupid', element.id);\n                if (element.groupid !== '') {\n                    element.groupname = element.groups.find((group) => group.id === parseInt(element.groupid)).name;\n                }\n                element.session = this.getValue('planitem', 'session', element.id);\n                // Set the error flag if startdate, enddate or groupid are empty.\n                if (element.startdate === '') {\n                    element.errorstartdate = true;\n                    element.error = true;\n                }\n                if (element.enddate === '') {\n                    element.errorenddate = true;\n                    element.error = true;\n                }\n                if (element.groupid === '') {\n                    element.errorgroupid = true;\n                    element.error = true;\n                }\n                if (element.startdate !== '' && element.enddate !== '' && element.groupid !== '') {\n                    element.error = false;\n                }\n                if (!element.session) {\n                    element.errorsession = true;\n                    element.error = true;\n                }\n            }\n            this.updatePauses(element);\n        });\n        CompetState.setData(state);\n    }\n\n    /**\n     * Update the pauses.\n     * @param {Object} element The element to update.\n     */\n    updatePauses(element) {\n        element.pauses.forEach((pause) => {\n            pause.haschanged = false;\n            if (pause.editpause) {\n                // Update the grid with the new values from the UI.\n                pause.haschanged = true;\n                pause.startdate = this.getValue('pauseitem', 'startdate', pause.id);\n                pause.enddate = this.getValue('pauseitem', 'enddate', pause.id);\n                // Set the error flag if startdate, enddate or groupid are empty.\n                // Get timestamp from iso date.\n                const startdate = new Date(pause.startdate).getTime();\n                const enddate = new Date(pause.enddate).getTime();\n                const elementstartdate = new Date(element.startdate).getTime();\n                const elementenddate = new Date(element.enddate).getTime();\n                if (startdate < elementstartdate) {\n                    pause.errorstartdate = true;\n                    pause.error = true;\n                }\n                if (enddate > elementenddate) {\n                    pause.errorenddate = true;\n                    pause.error = true;\n                }\n                if (pause.startdate === '') {\n                    pause.errorstartdate = true;\n                    pause.error = true;\n                }\n                if (pause.enddate === '') {\n                    pause.errorenddate = true;\n                    pause.error = true;\n                }\n                if (pause.startdate !== '' && pause.enddate !== '') {\n                    pause.error = false;\n                }\n            }\n        });\n    }\n\n    /**\n     * Get the planning object structure.\n     */\n    get planningObjectKeys() {\n        return ['id', 'situationid', 'startdate', 'enddate', 'groupid', 'session', 'pauses', 'haschanged', 'deleted'];\n    }\n\n    /**\n     * Get the pause object structure.\n     * @return {Array} The pause object keys.\n     */\n    get pauseObjectKeys() {\n        return ['id', 'planningid', 'startdate', 'enddate', 'haschanged', 'deleted'];\n    }\n\n    /**\n     * Save the state to the server.\n     *\n     * @return {Bool} True if the state was saved.\n     */\n    async save() {\n        this.update();\n        const state = CompetState.getData();\n        // If any element has an error, do not save.\n        if (state.plannings.find((element) => element.error)) {\n            return false;\n        }\n        // If any pause has an error, do not save.\n        if (state.plannings.find((element) => element.pauses.find((pause) => pause.error))) {\n            return false;\n        }\n        const saveState = {\n            plannings: [],\n        };\n        if (state.plannings.length > 0) {\n            saveState.plannings = [...state.plannings];\n        }\n        saveState.plannings.forEach((element) => {\n            // Delete all foreign keys.\n            Object.keys(element).forEach((key) => {\n                if (!this.planningObjectKeys.includes(key)) {\n                    delete element[key];\n                }\n            });\n            element.pauses.forEach((pause) => {\n                Object.keys(pause).forEach((key) => {\n                    if (!this.pauseObjectKeys.includes(key)) {\n                        delete pause[key];\n                    }\n                });\n            });\n        });\n        const result = await Repository.savePlannings(saveState);\n        this.getData();\n        return result;\n    }\n\n    /**\n     * Get the field value from the UI.\n     * @param {String} element The element to get the value from.\n     * @param {String} property The element property.\n     * @param {String} id The element id.\n     * @return {String} The value of the element.\n     */\n    getValue(element, property, id) {\n        const domNode = this.app.querySelector(`[data-region=\"${element}\"][data-id=\"${id}\"] [data-field=\"${property}\"]`);\n        if (!domNode) {\n            window.console.log(`Element not found: ${element} ${property} ${id}`);\n            const element = this.app.querySelector(`[data-region=\"${element}\"][data-id=\"${id}\"]`);\n            if (!element) {\n                window.console.log(`Element not found: ${element} ${id}`);\n                return '';\n            }\n        }\n        return domNode.value;\n    }\n\n    /**\n     * Get suggested values for the planning, based on the last planning.\n     *\n     * The startdate is the monday after the startdate of the last planning\n     * The enddate is the friday after the monday after the startdate of the last planning\n     * The session is the session of the last planning + 1, sessions need to be unique.\n     * @param {String} property The property to get the suggested value for.\n     * @return {String|Int} The suggested value.\n     */\n    getSuggested(property) {\n        const state = CompetState.getData();\n        let lastPlanning = state.plannings[state.plannings.length - 1];\n        let starttime = new Date().getTime();\n        let sessionDefault = 's';\n        if (lastPlanning) {\n            starttime = new Date(lastPlanning.enddate).getTime();\n        }\n\n        if (property === 'startdate') {\n            const date = new Date(starttime);\n            // Find the next monday.\n            date.setDate(date.getDate() + (1 + 7 - date.getDay()) % 7);\n           // Return in format yyyy-mm-ddThh:mm\n            return date.toISOString().slice(0, 16);\n        }\n        if (property === 'enddate') {\n            const date = new Date(starttime);\n            // Find the next monday.\n            date.setDate(date.getDate() + (1 + 7 - date.getDay()) % 7);\n            // Add 6 days.\n            date.setDate(date.getDate() + 6);\n            return date.toISOString().slice(0, 16);\n        }\n        if (property === 'session') {\n            // Check if this sessionname is unique.\n            const sessionnames = state.plannings.map((element) => element.session);\n            let counter = 1;\n            let session = sessionDefault + '-' + counter;\n            while (sessionnames.includes(session)) {\n                counter++;\n                session = sessionDefault + '-' + counter;\n            }\n            return session;\n        }\n        return '';\n    }\n}\n\n/*\n * Initialise\n *\n */\nconst init = () => {\n    new Manager();\n};\n\nexport default {\n    init: init,\n};\n"],"names":["Manager","constructor","app","document","querySelector","cmId","this","dataset","situationId","region","addEventListeners","getData","response","Repository","getPlannings","setData","addEventListener","e","btn","target","closest","preventDefault","actions","classList","add","action","edit","save","stopEdit","delete","deleteAll","state","CompetState","type","plannings","push","id","situationid","startdate","getSuggested","enddate","groupid","session","groups","pauses","planningid","parseInt","planning","find","element","editpause","deletePlanning","deleted","hasuserdata","modal","ModalSaveCancel","create","title","body","show","getRoot","on","ModalEvents","pauseid","getPause","length","confirmationStrings","key","component","confirm","forEach","pause","update","haschanged","getValue","groupname","group","name","errorstartdate","error","errorenddate","errorgroupid","errorsession","updatePauses","Date","getTime","elementstartdate","elementenddate","planningObjectKeys","pauseObjectKeys","saveState","Object","keys","includes","result","savePlannings","property","domNode","window","console","log","value","lastPlanning","starttime","date","setDate","getDate","getDay","toISOString","slice","sessionnames","map","counter","sessionDefault","init"],"mappings":"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"}