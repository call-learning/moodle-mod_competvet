define("mod_competvet/local/forms/eval_observation_ask",["exports","core/str","core/notification","core/modal_factory","core/ajax","core/templates","./generic_form_helper"],(function(_exports,_str,_notification,_modal_factory,_ajax,_templates,_generic_form_helper){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript adding a new observation.
   *
   * @module     mod_competvet/local/forms/observation_add_form
   * @copyright  2023 Laurent David <laurent@call-learning.fr>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initUsersAction=_exports.init=void 0,_notification=_interopRequireDefault(_notification),_modal_factory=_interopRequireDefault(_modal_factory),_ajax=_interopRequireDefault(_ajax),_templates=_interopRequireDefault(_templates);_exports.init=modulename=>{(0,_generic_form_helper.genericForm)("observation:ask",modulename,"eval_observation_ask",(async event=>{const askObservationTitle=await(0,_str.get_string)("observation:ask",modulename);try{const modal=await _modal_factory.default.create({title:askObservationTitle,body:_templates.default.render("".concat(modulename,"/view/eval_ask_observation_modal"),{modulename:modulename,...event.detail}),type:_modal_factory.default.types.CANCEL,large:!0});return modal.show(),modal}catch(error){await _notification.default.exception(error)}return null}))};_exports.initUsersAction=(modulename,planningId,studentId,context)=>{const selectedElements=document.querySelectorAll(".ask-observation-modal [data-user-id]");selectedElements&&selectedElements.forEach((element=>{element.addEventListener("click",(async event=>{event.preventDefault();const askEvalPayload={context:context,planningid:planningId,observerid:element.dataset.userId,studentid:studentId};try{(await _ajax.default.call([{methodname:"".concat(modulename,"_ask_eval_observation"),args:askEvalPayload}])[0]).success&&element.querySelector(".asked").classList.remove("d-none")}catch(error){const cannotAddString=await(0,_str.get_string)("todo:cannotadd",modulename);await _notification.default.exception({message:cannotAddString})}}))}))}}));

//# sourceMappingURL=eval_observation_ask.min.js.map